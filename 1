import mysql.connector
from flask import Flask, redirect, render_template, request
from flask_mysqldb import MySQL
app=Flask(__name__)
app.config['MYSQL_HOST']='eksdb6.c9ziquagji8m.ap-south-1.rds.amazonaws.com'
app.config['MYSQL_USER']='admin'
app.config['MYSQL_PASSWORD']='sulthana6'
app.config['MYSQL_DB']='Rasoolalah'
mysql=MySQL(app)
@app.route('/',methods=['GET','POST'])
def index():
    if request.method=='POST':
        userDetails=request.form
        name=userDetails['name']
        email=userDetails['email']
        cur=mysql.connection.cursor()
        cur.execute("INSERT INTO users(name,email) VALUES(%s,%s)",(name,email))
        mysql.connection.commit()
        cur.close()
        return redirect('/users')
    return render_template("form.html")
@app.route("/users")
def users():
    cur=mysql.connection.cursor()
    result=cur.execute("SELECT * FROM users")
    if result>0:
        userDetails=cur.fetchall()
        return render_template("users.html",userDetails=userDetails)

if __name__=='__main__':
   app.run(host='0.0.0.0',port=5000,debug=True,use_reloader=True)
   # app.run(debug=True)
